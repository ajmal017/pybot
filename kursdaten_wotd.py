import requests
import json
from time import sleep
import random
from datetime import datetime, timedelta

c_offline_data = {"name":"OFFLINE","history":{"2019-05-27":{"open":"157.00","close":"159.70","high":"159.70","low":"156.55","volume":"822254"},"2019-05-24":{"open":"155.50","close":"155.50","high":"156.40","low":"153.90","volume":"978466"},"2019-05-23":{"open":"156.75","close":"153.30","high":"157.80","low":"152.95","volume":"2041362"},"2019-05-22":{"open":"154.20","close":"158.85","high":"158.85","low":"152.40","volume":"3264393"},"2019-05-21":{"open":"144.60","close":"150.05","high":"150.05","low":"144.25","volume":"2072062"},"2019-05-20":{"open":"141.35","close":"143.75","high":"144.65","low":"138.60","volume":"1645266"},"2019-05-17":{"open":"139.65","close":"139.95","high":"142.30","low":"139.20","volume":"1246945"},"2019-05-16":{"open":"138.75","close":"140.05","high":"140.05","low":"137.60","volume":"1022817"},"2019-05-15":{"open":"139.00","close":"138.70","high":"139.75","low":"135.75","volume":"1168096"},"2019-05-14":{"open":"133.00","close":"137.40","high":"137.40","low":"133.00","volume":"1055888"},"2019-05-13":{"open":"133.50","close":"132.45","high":"135.05","low":"132.35","volume":"1162098"},"2019-05-10":{"open":"135.00","close":"134.80","high":"136.70","low":"133.10","volume":"1051658"},"2019-05-09":{"open":"139.15","close":"135.25","high":"139.40","low":"134.85","volume":"1439923"},"2019-05-08":{"open":"138.30","close":"140.00","high":"140.20","low":"133.80","volume":"3276032"},"2019-05-07":{"open":"128.95","close":"133.50","high":"133.50","low":"127.90","volume":"1466053"},"2019-05-06":{"open":"126.00","close":"126.55","high":"128.30","low":"125.15","volume":"1041118"},"2019-05-03":{"open":"130.10","close":"128.75","high":"131.25","low":"127.20","volume":"1216658"},"2019-05-02":{"open":"134.80","close":"130.15","high":"135.00","low":"130.15","volume":"1255879"},"2019-04-30":{"open":"134.50","close":"133.70","high":"136.65","low":"132.25","volume":"941329"},"2019-04-29":{"open":"134.60","close":"135.25","high":"137.15","low":"133.80","volume":"1424635"},"2019-04-26":{"open":"129.25","close":"133.75","high":"135.00","low":"128.70","volume":"1835904"},"2019-04-25":{"open":"137.00","close":"129.00","high":"140.45","low":"125.50","volume":"3503518"},"2019-04-24":{"open":"133.50","close":"134.00","high":"142.65","low":"128.40","volume":"5846564"},"2019-04-23":{"open":"113.05","close":"123.50","high":"124.10","low":"110.20","volume":"2316513"},"2019-04-18":{"open":"121.55","close":"120.10","high":"121.55","low":"117.00","volume":"1008147"},"2019-04-17":{"open":"123.15","close":"122.50","high":"124.00","low":"120.50","volume":"1181899"},"2019-04-16":{"open":"116.00","close":"117.90","high":"117.90","low":"115.00","volume":"914399"},"2019-04-15":{"open":"110.50","close":"113.85","high":"115.40","low":"110.50","volume":"893806"},"2019-04-12":{"open":"110.10","close":"110.40","high":"110.95","low":"109.70","volume":"509635"},"2019-04-11":{"open":"110.15","close":"110.80","high":"110.80","low":"108.65","volume":"424615"},"2019-04-10":{"open":"107.80","close":"109.20","high":"110.70","low":"106.85","volume":"593313"},"2019-04-09":{"open":"108.50","close":"107.20","high":"109.10","low":"106.70","volume":"492051"},"2019-04-08":{"open":"110.00","close":"109.50","high":"110.20","low":"108.90","volume":"344796"},"2019-04-05":{"open":"111.90","close":"110.95","high":"111.90","low":"110.10","volume":"534944"},"2019-04-04":{"open":"109.10","close":"110.10","high":"110.75","low":"108.65","volume":"645957"},"2019-04-03":{"open":"110.45","close":"108.10","high":"111.20","low":"107.80","volume":"1017254"},"2019-04-02":{"open":"110.30","close":"108.00","high":"111.10","low":"107.30","volume":"1151921"},"2019-04-01":{"open":"114.90","close":"109.55","high":"115.35","low":"108.55","volume":"1124408"},"2019-03-29":{"open":"120.00","close":"111.70","high":"120.00","low":"110.05","volume":"2251178"},"2019-03-28":{"open":"122.10","close":"122.40","high":"124.40","low":"122.10","volume":"929086"},"2019-03-27":{"open":"127.80","close":"124.35","high":"128.00","low":"118.15","volume":"1643201"},"2019-03-26":{"open":"101.00","close":"125.00","high":"130.35","low":"99.20","volume":"4289339"},"2019-03-25":{"open":"97.50","close":"99.00","high":"101.00","low":"93.12","volume":"1240270"},"2019-03-22":{"open":"104.25","close":"99.00","high":"105.20","low":"99.00","volume":"1353108"},"2019-03-21":{"open":"106.00","close":"101.10","high":"107.65","low":"101.00","volume":"1437739"},"2019-03-20":{"open":"112.80","close":"107.10","high":"114.30","low":"106.45","volume":"993139"},"2019-03-19":{"open":"108.10","close":"111.10","high":"112.95","low":"107.55","volume":"705454"},"2019-03-18":{"open":"107.10","close":"107.30","high":"108.45","low":"105.05","volume":"760730"},"2019-03-15":{"open":"105.30","close":"105.00","high":"109.75","low":"103.15","volume":"2639354"},"2019-03-14":{"open":"121.15","close":"115.10","high":"124.50","low":"113.80","volume":"1536543"},"2019-03-13":{"open":"120.55","close":"118.70","high":"125.40","low":"117.50","volume":"1522819"},"2019-03-12":{"open":"135.00","close":"127.05","high":"136.50","low":"123.40","volume":"1825632"},"2019-03-11":{"open":"125.60","close":"133.35","high":"134.30","low":"125.25","volume":"2256208"},"2019-03-08":{"open":"116.40","close":"123.85","high":"123.85","low":"116.05","volume":"1054003"},"2019-03-07":{"open":"117.10","close":"117.65","high":"118.60","low":"116.45","volume":"394762"},"2019-03-06":{"open":"118.80","close":"118.50","high":"119.50","low":"117.00","volume":"451602"},"2019-03-05":{"open":"117.30","close":"119.00","high":"119.00","low":"115.00","volume":"675928"},"2019-03-04":{"open":"120.70","close":"117.90","high":"120.80","low":"115.50","volume":"545212"},"2019-03-01":{"open":"121.15","close":"120.50","high":"121.90","low":"118.30","volume":"715071"},"2019-02-28":{"open":"117.15","close":"120.50","high":"120.50","low":"116.60","volume":"751069"},"2019-02-27":{"open":"118.00","close":"116.95","high":"118.10","low":"116.75","volume":"494600"},"2019-02-26":{"open":"116.50","close":"118.00","high":"118.00","low":"114.55","volume":"539191"},"2019-02-25":{"open":"119.50","close":"116.00","high":"119.70","low":"114.50","volume":"778940"},"2019-02-22":{"open":"113.10","close":"115.10","high":"115.10","low":"111.80","volume":"781827"},"2019-02-21":{"open":"115.00","close":"110.30","high":"115.40","low":"106.10","volume":"1390234"},"2019-02-20":{"open":"122.95","close":"114.25","high":"123.10","low":"111.85","volume":"1595455"},"2019-02-19":{"open":"121.80","close":"120.25","high":"126.20","low":"116.40","volume":"2323601"},"2019-02-18":{"open":"108.50","close":"115.00","high":"116.35","low":"105.05","volume":"2526713"},"2019-02-15":{"open":"102.00","close":"99.90","high":"103.15","low":"98.80","volume":"1668587"},"2019-02-14":{"open":"100.00","close":"102.25","high":"107.40","low":"98.80","volume":"2628662"},"2019-02-13":{"open":"97.40","close":"96.88","high":"101.10","low":"95.60","volume":"2256670"},"2019-02-12":{"open":"106.00","close":"101.85","high":"107.85","low":"95.32","volume":"2820181"},"2019-02-11":{"open":"97.60","close":"103.20","high":"104.60","low":"97.00","volume":"3347785"},"2019-02-08":{"open":"110.55","close":"96.86","high":"118.10","low":"86.00","volume":"10134920"},"2019-02-07":{"open":"129.40","close":"110.75","high":"130.65","low":"104.85","volume":"6739330"},"2019-02-06":{"open":"135.75","close":"130.30","high":"135.80","low":"124.00","volume":"2372900"},"2019-02-05":{"open":"127.50","close":"132.40","high":"133.00","low":"127.20","volume":"2397346"},"2019-02-04":{"open":"120.00","close":"123.40","high":"133.30","low":"114.40","volume":"7361789"},"2019-02-01":{"open":"145.65","close":"108.50","high":"151.40","low":"99.86","volume":"8018070"},"2019-01-31":{"open":"152.00","close":"144.70","high":"152.70","low":"142.80","volume":"2979970"},"2019-01-30":{"open":"167.00","close":"145.15","high":"169.10","low":"126.00","volume":"5264035"},"2019-01-29":{"open":"166.70","close":"167.40","high":"168.15","low":"164.25","volume":"748004"},"2019-01-28":{"open":"166.30","close":"166.60","high":"170.20","low":"165.45","volume":"912850"},"2019-01-25":{"open":"169.60","close":"167.40","high":"170.70","low":"166.95","volume":"1386080"},"2019-01-24":{"open":"161.50","close":"166.15","high":"166.80","low":"160.20","volume":"1439313"},"2019-01-23":{"open":"155.45","close":"160.00","high":"160.90","low":"154.75","volume":"1026556"},"2019-01-22":{"open":"153.85","close":"156.90","high":"157.90","low":"153.30","volume":"1100607"},"2019-01-21":{"open":"150.70","close":"154.00","high":"157.55","low":"149.70","volume":"1114743"},"2019-01-18":{"open":"144.90","close":"149.85","high":"151.45","low":"144.40","volume":"1509031"},"2019-01-17":{"open":"138.55","close":"143.00","high":"144.50","low":"137.70","volume":"935752"},"2019-01-16":{"open":"139.00","close":"139.15","high":"140.65","low":"137.20","volume":"566500"},"2019-01-15":{"open":"137.55","close":"138.10","high":"139.40","low":"135.85","volume":"597220"},"2019-01-14":{"open":"138.00","close":"135.90","high":"138.15","low":"135.15","volume":"633628"},"2019-01-11":{"open":"142.30","close":"139.75","high":"142.95","low":"139.35","volume":"563001"},"2019-01-10":{"open":"141.50","close":"141.75","high":"142.60","low":"138.90","volume":"721376"},"2019-01-09":{"open":"139.40","close":"142.95","high":"145.25","low":"138.60","volume":"1059428"},"2019-01-08":{"open":"136.00","close":"137.95","high":"140.00","low":"134.15","volume":"1120162"},"2019-01-07":{"open":"135.85","close":"136.45","high":"136.60","low":"134.85","volume":"601933"},"2019-01-04":{"open":"129.00","close":"133.25","high":"133.40","low":"129.00","volume":"862255"},"2019-01-03":{"open":"132.25","close":"126.95","high":"132.60","low":"126.35","volume":"1090150"},"2019-01-02":{"open":"133.00","close":"134.95","high":"136.25","low":"131.45","volume":"751653"},"2018-12-28":{"open":"129.30","close":"132.80","high":"132.95","low":"129.05","volume":"536831"},"2018-12-27":{"open":"129.70","close":"127.30","high":"131.35","low":"126.05","volume":"647678"},"2018-12-21":{"open":"128.00","close":"128.90","high":"130.90","low":"126.65","volume":"1265802"},"2018-12-20":{"open":"132.35","close":"128.75","high":"133.65","low":"127.80","volume":"1056331"},"2018-12-19":{"open":"132.65","close":"135.95","high":"137.75","low":"132.15","volume":"812484"},"2018-12-18":{"open":"133.85","close":"132.45","high":"135.35","low":"132.10","volume":"642779"},"2018-12-17":{"open":"137.50","close":"134.60","high":"138.00","low":"132.70","volume":"640304"},"2018-12-14":{"open":"135.65","close":"137.20","high":"138.55","low":"135.15","volume":"543057"},"2018-12-13":{"open":"138.30","close":"137.75","high":"139.85","low":"136.10","volume":"548735"},"2018-12-12":{"open":"139.00","close":"137.00","high":"139.25","low":"134.85","volume":"663623"},"2018-12-11":{"open":"135.50","close":"136.70","high":"140.20","low":"134.50","volume":"784486"},"2018-12-10":{"open":"131.85","close":"132.45","high":"133.75","low":"131.60","volume":"710191"},"2018-12-07":{"open":"132.00","close":"133.10","high":"138.05","low":"131.80","volume":"1038570"},"2018-12-06":{"open":"131.55","close":"129.50","high":"132.20","low":"128.00","volume":"1113757"},"2018-12-05":{"open":"135.00","close":"134.85","high":"136.50","low":"133.35","volume":"704000"},"2018-12-04":{"open":"139.45","close":"138.55","high":"142.30","low":"137.90","volume":"790184"},"2018-12-03":{"open":"139.25","close":"140.80","high":"141.75","low":"137.80","volume":"1086228"},"2018-11-30":{"open":"137.20","close":"133.45","high":"137.20","low":"132.50","volume":"1089173"},"2018-11-29":{"open":"135.80","close":"136.30","high":"138.35","low":"135.10","volume":"929601"},"2018-11-28":{"open":"132.10","close":"132.35","high":"134.25","low":"131.40","volume":"759160"},"2018-11-27":{"open":"137.20","close":"130.65","high":"137.35","low":"130.10","volume":"1035331"},"2018-11-26":{"open":"133.40","close":"135.80","high":"136.75","low":"132.70","volume":"873163"},"2018-11-23":{"open":"129.75","close":"131.95","high":"132.20","low":"129.10","volume":"630530"},"2018-11-22":{"open":"131.70","close":"130.10","high":"131.75","low":"127.70","volume":"620534"},"2018-11-21":{"open":"132.60","close":"131.75","high":"133.70","low":"129.60","volume":"1323598"},"2018-11-20":{"open":"129.50","close":"129.60","high":"132.55","low":"124.40","volume":"3412896"},"2018-11-19":{"open":"147.35","close":"137.60","high":"148.65","low":"135.65","volume":"1702942"},"2018-11-16":{"open":"150.50","close":"147.80","high":"151.00","low":"145.55","volume":"987880"},"2018-11-15":{"open":"152.00","close":"149.00","high":"153.80","low":"145.60","volume":"1003137"},"2018-11-14":{"open":"157.00","close":"149.10","high":"157.20","low":"145.20","volume":"1857160"},"2018-11-13":{"open":"152.45","close":"157.00","high":"157.50","low":"151.00","volume":"855285"},"2018-11-12":{"open":"159.40","close":"151.70","high":"160.80","low":"150.65","volume":"804880"},"2018-11-09":{"open":"159.90","close":"157.40","high":"161.95","low":"157.30","volume":"1138247"},"2018-11-08":{"open":"159.45","close":"155.70","high":"160.80","low":"155.05","volume":"727955"},"2018-11-07":{"open":"156.00","close":"158.10","high":"158.10","low":"153.90","volume":"779217"},"2018-11-06":{"open":"152.05","close":"154.50","high":"155.45","low":"151.95","volume":"739409"},"2018-11-05":{"open":"150.00","close":"150.95","high":"155.40","low":"149.15","volume":"900770"},"2018-11-02":{"open":"159.20","close":"151.75","high":"161.15","low":"151.20","volume":"2029144"},"2018-11-01":{"open":"165.35","close":"162.30","high":"167.10","low":"158.20","volume":"854155"},"2018-10-31":{"open":"162.20","close":"165.40","high":"167.05","low":"161.95","volume":"927642"},"2018-10-30":{"open":"164.15","close":"158.95","high":"164.80","low":"156.85","volume":"1039172"},"2018-10-29":{"open":"160.00","close":"160.05","high":"164.40","low":"159.60","volume":"738188"},"2018-10-26":{"open":"162.30","close":"159.55","high":"162.40","low":"153.40","volume":"1297030"},"2018-10-25":{"open":"158.20","close":"165.20","high":"165.95","low":"155.80","volume":"1011031"},"2018-10-24":{"open":"162.85","close":"161.85","high":"167.00","low":"160.70","volume":"766684"},"2018-10-23":{"open":"170.60","close":"161.05","high":"170.85","low":"159.55","volume":"1331921"},"2018-10-22":{"open":"175.00","close":"175.30","high":"177.00","low":"172.75","volume":"622047"},"2018-10-19":{"open":"172.65","close":"174.00","high":"176.00","low":"171.00","volume":"805356"},"2018-10-18":{"open":"176.35","close":"170.45","high":"178.40","low":"170.40","volume":"866299"},"2018-10-17":{"open":"177.60","close":"177.00","high":"181.80","low":"174.70","volume":"1038087"},"2018-10-16":{"open":"169.50","close":"174.15","high":"174.95","low":"166.60","volume":"927688"},"2018-10-15":{"open":"167.20","close":"169.60","high":"169.90","low":"161.75","volume":"798682"},"2018-10-12":{"open":"166.00","close":"168.05","high":"169.95","low":"160.85","volume":"1704385"},"2018-10-11":{"open":"150.00","close":"159.55","high":"166.00","low":"148.00","volume":"2202514"},"2018-10-10":{"open":"186.95","close":"156.25","high":"187.00","low":"149.50","volume":"2842544"},"2018-10-09":{"open":"173.10","close":"182.10","high":"182.70","low":"168.35","volume":"2322673"},"2018-10-08":{"open":"188.65","close":"166.20","high":"188.80","low":"162.00","volume":"2829681"},"2018-10-05":{"open":"190.00","close":"189.00","high":"191.25","low":"185.55","volume":"760772"},"2018-10-04":{"open":"191.75","close":"190.75","high":"194.40","low":"187.70","volume":"791039"},"2018-10-02":{"open":"190.45","close":"190.55","high":"192.50","low":"187.20","volume":"718910"},"2018-10-01":{"open":"188.50","close":"192.45","high":"193.00","low":"188.00","volume":"634170"},"2018-09-28":{"open":"188.10","close":"186.70","high":"191.00","low":"186.30","volume":"749688"},"2018-09-27":{"open":"189.70","close":"188.15","high":"190.85","low":"185.75","volume":"659548"},"2018-09-26":{"open":"192.85","close":"190.90","high":"194.15","low":"189.50","volume":"733177"},"2018-09-25":{"open":"183.50","close":"191.40","high":"191.55","low":"183.30","volume":"927184"},"2018-09-24":{"open":"177.85","close":"182.45","high":"183.40","low":"177.35","volume":"751868"},"2018-09-21":{"open":"176.00","close":"178.30","high":"179.65","low":"171.90","volume":"3727455"},"2018-09-20":{"open":"184.30","close":"176.20","high":"184.30","low":"167.30","volume":"2038456"},"2018-09-19":{"open":"188.20","close":"184.60","high":"188.95","low":"184.40","volume":"417397"},"2018-09-18":{"open":"187.15","close":"188.05","high":"188.75","low":"182.75","volume":"662875"},"2018-09-17":{"open":"189.50","close":"188.25","high":"190.00","low":"186.45","volume":"426826"},"2018-09-14":{"open":"184.80","close":"188.90","high":"189.20","low":"181.70","volume":"740667"},"2018-09-13":{"open":"185.65","close":"180.70","high":"189.00","low":"180.60","volume":"669707"},"2018-09-12":{"open":"188.25","close":"185.90","high":"191.25","low":"183.70","volume":"591126"},"2018-09-11":{"open":"187.80","close":"188.00","high":"189.70","low":"186.50","volume":"456430"},"2018-09-10":{"open":"194.40","close":"186.25","high":"195.45","low":"185.30","volume":"833817"},"2018-09-07":{"open":"188.50","close":"192.45","high":"193.15","low":"187.30","volume":"742421"},"2018-09-06":{"open":"185.00","close":"184.50","high":"188.40","low":"177.80","volume":"1362075"},"2018-09-05":{"open":"194.30","close":"182.10","high":"197.15","low":"182.10","volume":"1215891"},"2018-09-04":{"open":"198.20","close":"193.20","high":"199.00","low":"190.90","volume":"767799"},"2018-09-03":{"open":"192.45","close":"195.75","high":"197.20","low":"192.20","volume":"421881"},"2018-08-31":{"open":"191.50","close":"191.30","high":"192.30","low":"190.15","volume":"576294"},"2018-08-30":{"open":"191.50","close":"191.20","high":"193.45","low":"186.05","volume":"555808"},"2018-08-29":{"open":"193.35","close":"191.40","high":"194.35","low":"188.65","volume":"665308"},"2018-08-28":{"open":"195.05","close":"192.20","high":"196.10","low":"188.45","volume":"749226"},"2018-08-27":{"open":"190.50","close":"194.25","high":"195.25","low":"190.15","volume":"637522"},"2018-08-24":{"open":"188.30","close":"188.40","high":"188.50","low":"185.10","volume":"472412"},"2018-08-23":{"open":"181.90","close":"186.45","high":"186.90","low":"180.70","volume":"528153"},"2018-08-22":{"open":"179.70","close":"180.90","high":"183.60","low":"179.30","volume":"536558"},"2018-08-21":{"open":"185.80","close":"180.80","high":"186.55","low":"178.50","volume":"823486"},"2018-08-20":{"open":"182.90","close":"184.60","high":"185.90","low":"181.55","volume":"993550"},"2018-08-17":{"open":"179.90","close":"178.80","high":"180.00","low":"174.65","volume":"728790"},"2018-08-16":{"open":"169.20","close":"176.20","high":"178.40","low":"168.35","volume":"1116371"},"2018-08-15":{"open":"171.00","close":"161.25","high":"171.35","low":"159.95","volume":"913189"},"2018-08-14":{"open":"171.00","close":"170.35","high":"172.15","low":"169.70","volume":"486868"},"2018-08-13":{"open":"168.00","close":"169.80","high":"170.50","low":"166.55","volume":"368509"},"2018-08-10":{"open":"167.60","close":"168.55","high":"168.70","low":"166.10","volume":"365137"},"2018-08-09":{"open":"166.80","close":"168.45","high":"168.50","low":"165.20","volume":"381504"},"2018-08-08":{"open":"165.15","close":"166.50","high":"167.85","low":"164.25","volume":"461515"},"2018-08-07":{"open":"167.70","close":"164.90","high":"169.35","low":"163.05","volume":"514376"},"2018-08-06":{"open":"165.10","close":"166.15","high":"166.85","low":"163.70","volume":"373851"},"2018-08-03":{"open":"162.70","close":"164.00","high":"165.00","low":"162.00","volume":"386286"},"2018-08-02":{"open":"159.40","close":"161.85","high":"162.90","low":"159.20","volume":"571399"},"2018-08-01":{"open":"160.50","close":"160.80","high":"162.70","low":"158.20","volume":"317217"},"2018-07-31":{"open":"161.40","close":"159.75","high":"161.85","low":"157.85","volume":"551672"},"2018-07-30":{"open":"162.50","close":"160.15","high":"164.15","low":"160.15","volume":"443789"},"2018-07-27":{"open":"163.60","close":"161.90","high":"163.95","low":"161.65","volume":"331609"},"2018-07-26":{"open":"161.55","close":"163.05","high":"163.45","low":"159.65","volume":"423029"},"2018-07-25":{"open":"160.15","close":"160.00","high":"160.95","low":"154.15","volume":"644952"},"2018-07-24":{"open":"162.70","close":"159.90","high":"164.50","low":"158.45","volume":"786008"},"2018-07-23":{"open":"156.05","close":"159.45","high":"159.65","low":"155.85","volume":"614681"},"2018-07-20":{"open":"153.65","close":"155.60","high":"156.75","low":"152.60","volume":"492823"},"2018-07-19":{"open":"155.00","close":"153.95","high":"155.85","low":"152.80","volume":"284717"},"2018-07-18":{"open":"155.00","close":"155.20","high":"157.25","low":"154.70","volume":"472008"},"2018-07-17":{"open":"153.70","close":"153.90","high":"154.50","low":"146.05","volume":"526484"},"2018-07-16":{"open":"151.95","close":"153.70","high":"153.90","low":"151.80","volume":"257437"},"2018-07-13":{"open":"153.05","close":"151.95","high":"154.10","low":"151.25","volume":"372288"},"2018-07-12":{"open":"148.85","close":"152.00","high":"152.80","low":"148.50","volume":"421354"},"2018-07-11":{"open":"146.90","close":"147.75","high":"148.30","low":"144.30","volume":"347215"},"2018-07-10":{"open":"146.55","close":"149.10","high":"149.85","low":"146.15","volume":"376221"},"2018-07-09":{"open":"145.05","close":"145.55","high":"146.25","low":"144.65","volume":"267567"},"2018-07-06":{"open":"145.65","close":"143.80","high":"146.20","low":"142.70","volume":"401869"},"2018-07-05":{"open":"138.40","close":"144.05","high":"144.55","low":"138.40","volume":"493253"},"2018-07-04":{"open":"137.35","close":"137.80","high":"138.25","low":"136.10","volume":"301435"},"2018-07-03":{"open":"138.00","close":"137.15","high":"140.00","low":"136.05","volume":"322199"},"2018-07-02":{"open":"134.80","close":"135.75","high":"138.70","low":"134.00","volume":"403002"},"2018-06-29":{"open":"138.15","close":"137.95","high":"140.30","low":"137.05","volume":"586146"},"2018-06-28":{"open":"143.30","close":"135.40","high":"145.55","low":"128.80","volume":"1037706"},"2018-06-27":{"open":"146.05","close":"144.50","high":"146.05","low":"139.70","volume":"569151"},"2018-06-26":{"open":"140.25","close":"145.50","high":"147.30","low":"138.70","volume":"880357"},"2018-06-25":{"open":"146.60","close":"139.45","high":"147.10","low":"139.45","volume":"682915"},"2018-06-22":{"open":"147.15","close":"147.20","high":"147.90","low":"145.70","volume":"345743"},"2018-06-21":{"open":"149.55","close":"147.00","high":"150.95","low":"144.65","volume":"608656"},"2018-06-20":{"open":"145.85","close":"147.50","high":"151.05","low":"145.60","volume":"883403"},"2018-06-19":{"open":"143.50","close":"143.75","high":"146.50","low":"138.80","volume":"871115"},"2018-06-18":{"open":"146.95","close":"146.55","high":"147.90","low":"144.60","volume":"792803"},"2018-06-15":{"open":"156.75","close":"147.50","high":"158.10","low":"142.50","volume":"2435304"},"2018-06-14":{"open":"150.55","close":"156.30","high":"156.35","low":"148.40","volume":"991367"},"2018-06-13":{"open":"147.55","close":"151.55","high":"154.00","low":"147.10","volume":"1475057"},"2018-06-12":{"open":"145.40","close":"146.20","high":"146.50","low":"144.15","volume":"545766"},"2018-06-11":{"open":"143.10","close":"144.00","high":"144.40","low":"142.55","volume":"548003"},"2018-06-08":{"open":"139.20","close":"142.00","high":"142.10","low":"137.80","volume":"599654"},"2018-06-07":{"open":"139.20","close":"139.45","high":"141.20","low":"138.35","volume":"580366"},"2018-06-06":{"open":"139.00","close":"138.15","high":"139.15","low":"136.55","volume":"490232"},"2018-06-05":{"open":"138.90","close":"137.80","high":"140.90","low":"137.55","volume":"654305"},"2018-06-04":{"open":"136.50","close":"136.80","high":"137.35","low":"133.20","volume":"645978"},"2018-06-01":{"open":"133.00","close":"133.30","high":"133.40","low":"132.15","volume":"387581"},"2018-05-31":{"open":"131.90","close":"132.15","high":"133.00","low":"131.15","volume":"582545"},"2018-05-30":{"open":"129.90","close":"130.45","high":"130.90","low":"128.35","volume":"454602"},"2018-05-29":{"open":"131.40","close":"129.25","high":"131.45","low":"129.15","volume":"572223"},"2018-05-28":{"open":"130.65","close":"132.55","high":"133.15","low":"130.35","volume":"389445"}}}

def get_stock_data_wotd(stock):

    trading_day = {"date" : "1900-01-01", "open" : 0, "high" : 0, "low" : 0, "close" : 0, "volume" : 0}
    stock_data = []
    no_data = True

    dt = datetime.today() - timedelta(days=365)
    date = dt.strftime('%Y-%m-%d')
    #date = '2015-01-01'

    keys = ["wq5pGbL5D7afdTjXIJuYKPHGZchgsDsDyHGpxHPRsblEWHKoccnavQWdFGHq","dCnmxq7wmGSWrgdbU0zUeAvflvqNE2n9Cc9t4K3iNp1bpi6b2Y7wbaHy92uA","QX5Y9J1tkhFrIF91ADrkfzBznag2NcSjSKABpcVuUV1oHa4IpvBN9yLUmoQV"]
    key = random.choice(keys)


    url = "https://www.worldtradingdata.com/api/v1/stock?symbol="+stock+"&api_token="+key
    resp = requests.get(url)

    if "data" in resp.json():

    		trading_day["date"] = resp.json()["data"][0]["last_trade_time"][:10]

    		trading_day["open"] = float(resp.json()["data"][0]["price_open"])
    		trading_day["high"] = float(resp.json()["data"][0]["day_high"])
    		trading_day["low"] = float(resp.json()["data"][0]["day_low"])
    		trading_day["close"] = float(resp.json()["data"][0]["price"])
    		trading_day["volume"] = float(resp.json()["data"][0]["volume"])

    		stock_data.append(trading_day)


    url = "https://www.worldtradingdata.com/api/v1/history?symbol="+stock+"&date_from="+date+"&sort=newest&api_token="+key
    resp = requests.get(url)

    if "history" in resp.json() and len(resp.json()["history"]) > 201:
        no_data = False

    if no_data:

        print(stock+": NO DATA!")
        resp = c_offline_data

    for ts in resp.json()["history"]:

        date = str(ts)
        trading_day["date"] = date

        trading_day["open"] = float(resp.json()["history"][date]["open"])
        trading_day["high"] = float(resp.json()["history"][date]["high"])
        trading_day["low"] = float(resp.json()["history"][date]["low"])
        trading_day["close"] = float(resp.json()["history"][date]["close"])
        trading_day["volume"] = float(resp.json()["history"][date]["volume"])

        stock_data.append(trading_day)
        trading_day = {"date" : "1900-01-01", "open" : 0, "high" : 0, "low" : 0, "close" : 0, "volume" : 0}

        stock_data = sorted(stock_data, key = lambda i: i['date'],reverse=True)


    return stock_data
